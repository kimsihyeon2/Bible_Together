/**
 * 쉬운성경 실제 텍스트 패치 스크립트
 * 
 * 웹 검색을 통해 찾은 실제 '쉬운성경' 텍스트로 KLB 대체본을 덮어씀
 * 총 27개 절
 */

const fs = require('fs-extra');
const path = require('path');

const VERSES = {
    '신명기': {
        '6': { '25': "만일 우리가 우리 하나님 여호와께서 명령하신 이 모든 법을 충실히 지키면 여호와께서 우리를 의로운 사람으로 여기실 것이다." },
        '15': { '23': "그러나 피를 먹어서는 안 된다. 피는 물을 붓듯이 땅 위에 쏟아 버려라." }
    },
    '시편': {
        '92': {
            '14': "늙어서도 여전히 열매를 맺으며, 진액이 넘치고, 항상 푸르를 것이다.",
            '15': "여호와의 정직하심과 나의 바위 되심과 그에게는 불의가 없음이 선포되리로다."
        },
        '105': { '45': "이렇게 하신 것은 그들에게 주의 법을 따르게 하고, 주의 명령에 순종하게 하기 위함이었습니다. 여호와를 찬양하십시오." }
    },
    '사도행전': {
        '15': { '41': "바울은 시리아와 길리기아를 거쳐 가면서, 그곳에 있는 교회들을 튼튼하게 해 주었다." },
        '24': { '27': "두 해가 지난 후에 보르기오 베스도가 벨릭스의 후임으로 총독이 되었습니다. 그런데 벨릭스는 유대인들에게 환심을 사려고 바울을 그대로 감옥에 가두어 두었습니다." }
    },
    '로마서': {
        '9': { '33': "성경에 \"보아라, 내가 시온에 사람들의 발에 부딪치게 하는 돌과 사람들을 걸려 넘어지게 하는 바위를 놓으리니, 그를 믿는 사람은 부끄러움을 당하지 않을 것이다.\"라고 기록된 것과 같습니다." }
    },
    '요한계시록': {
        '21': {
            '5': "그 때, 보좌에 앉으신 분이 말씀하셨습니다. '보라, 내가 만물을 새롭게 하노라.' 또 말씀하셨습니다. '이 말은 신실하고 참되니 기록하여라.'",
            '7': "이기는 자는 이것들을 상속받으리라. 나는 그의 하나님이 되고 그는 나의 아들이 되리라.",
            '11': "그 성은 하나님의 영광을 가지고 있었는데, 그 빛이 지극히 귀한 보석 같고 벽옥과 수정같이 맑았습니다.",
            '13': "동쪽에 세 문, 북쪽에 세 문, 남쪽에 세 문, 서쪽에 세 문이 있었습니다.",
            '14': "그 성곽에는 열두 기초석이 있었고, 그 위에는 어린 양의 열두 사도의 열두 이름이 있었습니다.",
            '16': "그 성은 네모가 반듯하여 길이가 너비와 같았습니다. 그가 갈대로 그 성을 측량하니 만 이천 스다디온이요, 길이와 너비와 높이가 같았습니다.",
            '17': "그 성곽을 측량하니 백사십사 규빗이었습니다. 이것은 사람의 측량 곧 천사의 측량입니다.",
            '22': "나는 성 안에서 성전을 보지 못했습니다. 이는 주 하나님 곧 전능하신 이와 어린 양이 그 성의 성전이 되시기 때문입니다.",
            '23': "그 성은 해나 달의 비침이 필요 없으니, 이는 하나님의 영광이 그 성을 비추고 어린 양이 그 성의 등불이 되시기 때문입니다.",
            '25': "그 성의 문들은 낮에 결코 닫히지 않을 것이며, 거기에는 밤이 없을 것입니다."
        },
        '22': {
            '1': "그러고 나서 그 천사가 수정처럼 맑은 생명의 물이 흐르는 강을 내게 보여 주었습니다. 강은 하나님과 어린 양의 보좌에서 나와,",
            '9': "그러자 그는 '그렇게 하지 말아라. 나도 너와 네 형제 예언자들과 이 책의 말씀을 지키는 사람들과 같은 종이다. 그러므로 너는 하나님에게만 경배하여라' 하였습니다.",
            '10': "그러고서 천사는 다시 나에게 말했습니다. '때가 가까웠으니 이 책에 기록된 예언의 말씀을 봉하지 말아라.",
            '11': "악한 사람은 계속 악을 행하게 하고 더러운 사람은 계속 더럽게 내버려 두고 의로운 사람은 계속 의로운 일을 하게 하고 거룩한 사람은 계속 거룩하게 하라.'",
            '14': "자기 옷을 빠는 사람은 행복한 사람이다. 그들은 생명 나무에 나아갈 권세가 있고, 문들을 통하여 성에 들어갈 수 있기 때문이다.",
            '15': "그러나 개들과 점술가들과 음행하는 자들과 살인자들과 우상 숭배자들과 거짓말을 좋아하며 지어내는 자는 다 성 밖에 있으리라.",
            '18': "나는 이 책에 기록된 예언의 말씀을 듣는 모든 사람에게 증언합니다. 누구든지 여기에 무엇을 덧붙이면, 하나님께서 이 책에 기록된 재앙들을 그에게 더하실 것이요,",
            '19': "만일 누구든지 이 예언의 책의 말씀에서 무엇을 제하면, 하나님께서 이 책에 기록된 생명 나무와 거룩한 성에서 그가 누릴 몫을 제하여 버리실 것입니다.",
            '20': "이 모든 것을 증언하시는 분이 말씀하셨습니다. '정녕 내가 속히 오리라.' 아멘. 주 예수여, 오시옵소서!"
        }
    }
};

async function patch() {
    console.log('🚀 쉬운성경 실제 텍스트 패치 시작...\n');
    const filePath = path.join(__dirname, '../public/bible/ko_easy.json');

    try {
        const easy = await fs.readJson(filePath);
        let patchedCount = 0;

        for (const [book, chapters] of Object.entries(VERSES)) {
            for (const [ch, verses] of Object.entries(chapters)) {
                for (const [v, text] of Object.entries(verses)) {
                    if (easy[book] && easy[book][ch]) {
                        easy[book][ch][v] = text;
                        console.log(`✅ [복구] ${book} ${ch}:${v}`);
                        patchedCount++;
                    } else {
                        console.error(`❌ 구조 없음: ${book} ${ch}:${v}`);
                    }
                }
            }
        }

        await fs.outputJson(filePath, easy, { spaces: 0 });
        console.log(`\n==================================================`);
        console.log(`🎉 패치 완료! 총 ${patchedCount}개 절 복구됨`);
        console.log(`==================================================`);

    } catch (error) {
        console.error('에러 발생:', error);
    }
}

patch();
